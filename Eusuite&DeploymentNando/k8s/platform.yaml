# =============================================================================
# EUSuite Platform - Kubernetes Manifests (eucloud namespace)
# =============================================================================

---
# =============================================================================
# NAMESPACE
# =============================================================================
apiVersion: v1
kind: Namespace
metadata:
  name: eucloud
  labels:
    app.kubernetes.io/name: eucloud
    app.kubernetes.io/part-of: eusuite-platform

---
# =============================================================================
# SECRETS
# =============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: eusuite-secrets
  namespace: eucloud
type: Opaque
data:
  # echo -n "value" | base64
  database-url: cG9zdGdyZXNxbDovL2V1c3VpdGU6cGFzc3dvcmRAcG9zdGdyZXM6NTQzMi9ldXN1aXRl
  jwt-secret: c3VwZXItc2VjcmV0LWp3dC1rZXktY2hhbmdlLWluLXByb2R1Y3Rpb24=

---
# =============================================================================
# CONFIGMAP
# =============================================================================
apiVersion: v1
kind: ConfigMap
metadata:
  name: eusuite-config
  namespace: eucloud
data:
  ENVIRONMENT: "production"
  LOG_LEVEL: "info"
  CORS_ORIGINS: "*"

---
# =============================================================================
# EUCLOUD CORE BACKEND (CRITICAL - All services depend on this)
# =============================================================================
apiVersion: apps/v1
kind: Deployment
metadata:
  name: eucloud-backend
  namespace: eucloud
  labels:
    app: eucloud-backend
spec:
  replicas: 1
  selector:
    matchLabels:
      app: eucloud-backend
  template:
    metadata:
      labels:
        app: eucloud-backend
    spec:
      imagePullSecrets:
        - name: dockerhub-credentials
      containers:
        - name: eucloud-backend
          image: dylan016504/eucloud-backend:latest
          ports:
            - containerPort: 80
          env:
            - name: DATABASE_URL
              valueFrom:
                secretKeyRef:
                  name: eusuite-secrets
                  key: database-url
            - name: JWT_SECRET
              valueFrom:
                secretKeyRef:
                  name: eusuite-secrets
                  key: jwt-secret
          resources:
            requests:
              memory: "256Mi"
              cpu: "200m"
            limits:
              memory: "512Mi"
              cpu: "500m"

---
apiVersion: v1
kind: Service
metadata:
  name: eucloud-backend
  namespace: eucloud
spec:
  selector:
    app: eucloud-backend
  ports:
    - port: 80
      targetPort: 80
      nodePort: 30706
  type: NodePort

---
# =============================================================================
# PUBLIC BACKEND
# =============================================================================
apiVersion: apps/v1
kind: Deployment
metadata:
  name: eusuite-public-backend
  namespace: eucloud
  labels:
    app: eusuite-public-backend
spec:
  replicas: 1
  selector:
    matchLabels:
      app: eusuite-public-backend
  template:
    metadata:
      labels:
        app: eusuite-public-backend
    spec:
      imagePullSecrets:
        - name: dockerhub-credentials
      containers:
        - name: eusuite-public-backend
          image: dylan016504/eusuite-public-backend:latest
          ports:
            - containerPort: 8000
          env:
            - name: DATABASE_URL
              valueFrom:
                secretKeyRef:
                  name: eusuite-secrets
                  key: database-url
            - name: JWT_SECRET
              valueFrom:
                secretKeyRef:
                  name: eusuite-secrets
                  key: jwt-secret
          resources:
            requests:
              memory: "128Mi"
              cpu: "100m"
            limits:
              memory: "256Mi"
              cpu: "200m"

---
apiVersion: v1
kind: Service
metadata:
  name: eusuite-public-backend
  namespace: eucloud
spec:
  selector:
    app: eusuite-public-backend
  ports:
    - port: 8000
      targetPort: 8000
      nodePort: 30700
  type: NodePort

---
# =============================================================================
# PUBLIC FRONTEND
# =============================================================================
apiVersion: apps/v1
kind: Deployment
metadata:
  name: eusuite-public-frontend
  namespace: eucloud
  labels:
    app: eusuite-public-frontend
spec:
  replicas: 1
  selector:
    matchLabels:
      app: eusuite-public-frontend
  template:
    metadata:
      labels:
        app: eusuite-public-frontend
    spec:
      imagePullSecrets:
        - name: dockerhub-credentials
      containers:
        - name: eusuite-public-frontend
          image: dylan016504/eusuite-public-frontend:latest
          ports:
            - containerPort: 80
          resources:
            requests:
              memory: "64Mi"
              cpu: "50m"
            limits:
              memory: "128Mi"
              cpu: "100m"

---
apiVersion: v1
kind: Service
metadata:
  name: eusuite-public-frontend
  namespace: eucloud
spec:
  selector:
    app: eusuite-public-frontend
  ports:
    - port: 80
      targetPort: 80
      nodePort: 30701
  type: NodePort

---
# =============================================================================
# COMPANY BACKEND
# =============================================================================
apiVersion: apps/v1
kind: Deployment
metadata:
  name: eusuite-company-backend
  namespace: eucloud
  labels:
    app: eusuite-company-backend
spec:
  replicas: 1
  selector:
    matchLabels:
      app: eusuite-company-backend
  template:
    metadata:
      labels:
        app: eusuite-company-backend
    spec:
      imagePullSecrets:
        - name: dockerhub-credentials
      containers:
        - name: eusuite-company-backend
          image: dylan016504/eusuite-company-backend:latest
          ports:
            - containerPort: 8000
          env:
            - name: DATABASE_URL
              valueFrom:
                secretKeyRef:
                  name: eusuite-secrets
                  key: database-url
            - name: JWT_SECRET
              valueFrom:
                secretKeyRef:
                  name: eusuite-secrets
                  key: jwt-secret
          resources:
            requests:
              memory: "128Mi"
              cpu: "100m"
            limits:
              memory: "256Mi"
              cpu: "200m"

---
apiVersion: v1
kind: Service
metadata:
  name: eusuite-company-backend
  namespace: eucloud
spec:
  selector:
    app: eusuite-company-backend
  ports:
    - port: 8000
      targetPort: 8000
      nodePort: 30702
  type: NodePort

---
# =============================================================================
# COMPANY FRONTEND
# =============================================================================
apiVersion: apps/v1
kind: Deployment
metadata:
  name: eusuite-company-frontend
  namespace: eucloud
  labels:
    app: eusuite-company-frontend
spec:
  replicas: 1
  selector:
    matchLabels:
      app: eusuite-company-frontend
  template:
    metadata:
      labels:
        app: eusuite-company-frontend
    spec:
      imagePullSecrets:
        - name: dockerhub-credentials
      containers:
        - name: eusuite-company-frontend
          image: dylan016504/eusuite-company-frontend:latest
          ports:
            - containerPort: 80
          resources:
            requests:
              memory: "64Mi"
              cpu: "50m"
            limits:
              memory: "128Mi"
              cpu: "100m"

---
apiVersion: v1
kind: Service
metadata:
  name: eusuite-company-frontend
  namespace: eucloud
spec:
  selector:
    app: eusuite-company-frontend
  ports:
    - port: 80
      targetPort: 80
      nodePort: 30703
  type: NodePort

---
# =============================================================================
# SUPERADMIN BACKEND
# =============================================================================
apiVersion: apps/v1
kind: Deployment
metadata:
  name: eusuite-superadmin-backend
  namespace: eucloud
  labels:
    app: eusuite-superadmin-backend
spec:
  replicas: 1
  selector:
    matchLabels:
      app: eusuite-superadmin-backend
  template:
    metadata:
      labels:
        app: eusuite-superadmin-backend
    spec:
      imagePullSecrets:
        - name: dockerhub-credentials
      containers:
        - name: eusuite-superadmin-backend
          image: dylan016504/eusuite-superadmin-backend:latest
          ports:
            - containerPort: 8000
          env:
            - name: DATABASE_URL
              valueFrom:
                secretKeyRef:
                  name: eusuite-secrets
                  key: database-url
            - name: JWT_SECRET
              valueFrom:
                secretKeyRef:
                  name: eusuite-secrets
                  key: jwt-secret
          resources:
            requests:
              memory: "128Mi"
              cpu: "100m"
            limits:
              memory: "256Mi"
              cpu: "200m"

---
apiVersion: v1
kind: Service
metadata:
  name: eusuite-superadmin-backend
  namespace: eucloud
spec:
  selector:
    app: eusuite-superadmin-backend
  ports:
    - port: 8000
      targetPort: 8000
      nodePort: 30704
  type: NodePort

---
# =============================================================================
# SUPERADMIN FRONTEND
# =============================================================================
apiVersion: apps/v1
kind: Deployment
metadata:
  name: eusuite-superadmin-frontend
  namespace: eucloud
  labels:
    app: eusuite-superadmin-frontend
spec:
  replicas: 1
  selector:
    matchLabels:
      app: eusuite-superadmin-frontend
  template:
    metadata:
      labels:
        app: eusuite-superadmin-frontend
    spec:
      imagePullSecrets:
        - name: dockerhub-credentials
      containers:
        - name: eusuite-superadmin-frontend
          image: dylan016504/eusuite-superadmin-frontend:latest
          ports:
            - containerPort: 80
          resources:
            requests:
              memory: "64Mi"
              cpu: "50m"
            limits:
              memory: "128Mi"
              cpu: "100m"

---
apiVersion: v1
kind: Service
metadata:
  name: eusuite-superadmin-frontend
  namespace: eucloud
spec:
  selector:
    app: eusuite-superadmin-frontend
  ports:
    - port: 80
      targetPort: 80
      nodePort: 30705
  type: NodePort
